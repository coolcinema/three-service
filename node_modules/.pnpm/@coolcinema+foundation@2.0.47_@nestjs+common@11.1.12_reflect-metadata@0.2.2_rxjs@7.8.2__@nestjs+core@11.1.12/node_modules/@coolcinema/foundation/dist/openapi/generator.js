"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateSpecFile = generateSpecFile;
const zod_openapi_1 = require("zod-openapi");
const fs = require("fs");
const path = require("path");
const yaml = require("js-yaml");
function generateSpecFile(routes, options) {
    const paths = {};
    Object.values(routes).forEach((route) => {
        if (!paths[route.path])
            paths[route.path] = {};
        Object.assign(paths[route.path], route.config);
    });
    const doc = (0, zod_openapi_1.createDocument)({
        openapi: "3.1.0",
        info: { title: options.title, version: options.version },
        paths: paths,
    });
    const outPath = path.resolve(process.cwd(), options.out || "dist/openapi.yaml");
    const dir = path.dirname(outPath);
    if (!fs.existsSync(dir))
        fs.mkdirSync(dir, { recursive: true });
    fs.writeFileSync(outPath, yaml.dump(doc));
    console.log(`âœ… OpenAPI spec generated at ${outPath}`);
}
//# sourceMappingURL=generator.js.map
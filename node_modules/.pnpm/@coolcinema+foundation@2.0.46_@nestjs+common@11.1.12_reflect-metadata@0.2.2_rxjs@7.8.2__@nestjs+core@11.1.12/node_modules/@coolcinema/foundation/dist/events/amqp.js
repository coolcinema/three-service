"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AmqpTransport = void 0;
const amqp_connection_manager_1 = require("amqp-connection-manager");
class AmqpTransport {
    constructor(registry, config) {
        const url = config?.url || registry.brokers?.rabbitmq;
        if (!url) {
            throw new Error("RabbitMQ URI is not defined. Check registry.json or provide config.");
        }
        this.connection = amqp_connection_manager_1.default.connect([url]);
        this.channel = this.connection.createChannel({
            json: true,
            setup: (channel) => {
                return Promise.resolve();
            },
        });
    }
    getChannel() {
        return this.channel;
    }
    async close() {
        await this.connection.close();
    }
}
exports.AmqpTransport = AmqpTransport;
//# sourceMappingURL=amqp.js.map